<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Profile | Yeeps-Share</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <nav class="top-nav"><a href="../index.html">⬅️ Back to Feed</a></nav>

    <div class="admin-panel" style="text-align:center; margin-top:20px;">
        <img id="userPfp" src="https://ui-avatars.com/api/?name=?" class="pfp-img" style="width:100px; height:100px; border-radius:50%;">
        <h1 id="userName" style="color:var(--yeeps-orange);">Loading...</h1>
        <p id="userBio" style="font-style:italic;">No bio set.</p>
    </div>

    <h2 style="text-align:center;">Posts</h2>
    <div id="userPosts"></div>

    <script>
        // PASTE YOUR FIREBASE CONFIG HERE
        const firebaseConfig = { /* YOUR KEYS */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // FIX: Get the username from the URL correctly
        const params = new URLSearchParams(window.location.search);
        const targetUser = params.get('u');

        if (targetUser) {
            document.getElementById('userName').innerText = targetUser;
            
            // 1. Load User Bio and PFP
            db.collection("users").doc(targetUser).get().then(doc => {
                if(doc.exists) {
                    const data = doc.data();
                    if(data.pfp) document.getElementById('userPfp').src = data.pfp;
                    if(data.bio) document.getElementById('userBio').innerText = data.bio;
                }
            });

            // 2. Load User Posts
            db.collection("posts").where("username", "==", targetUser).onSnapshot(snap => {
                const feed = document.getElementById('userPosts');
                feed.innerHTML = "";
                snap.forEach(doc => {
                    const p = doc.data();
                    feed.innerHTML += `
                        <div class="post">
                            <p>${p.content}</p>
                            ${p.media ? `<img src="${p.media}" style="width:100%; border-radius:10px;">` : ''}
                        </div>`;
                });
            });
        }
    </script>
</body>
</html>
