<<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Profile | Yeeps-Share</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <nav class="top-nav"><a href="../index.html">Back to Feed</a></nav>

    <div class="admin-panel" style="text-align:center;">
        <img id="userPfp" src="" class="pfp-img" style="width:100px; height:100px;">
        <h1 id="userName">User</h1>
        <p id="userBio" style="font-style:italic; color:gray;">No bio set.</p>
    </div>

    <h3 style="text-align:center;">User's Posts</h3>
    <div id="userPosts"></div>

    <script>
        const firebaseConfig = { /* ... your config ... */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const urlParams = new URLSearchParams(window.location.search);
        const targetUser = urlParams.get('u');

        // Load User Info
        db.collection("users").doc(targetUser).get().then(doc => {
            if(doc.exists) {
                document.getElementById('userPfp').src = doc.data().pfp || "https://ui-avatars.com/api/?name=" + targetUser;
                document.getElementById('userBio').innerText = doc.data().bio || "No bio set.";
            } else {
                document.getElementById('userPfp').src = "https://ui-avatars.com/api/?name=" + targetUser;
            }
            document.getElementById('userName').innerText = targetUser;
        });

        // Load only this user's posts
        db.collection("posts").where("username", "==", targetUser).onSnapshot(snap => {
            const feed = document.getElementById('userPosts');
            feed.innerHTML = "";
            snap.forEach(doc => {
                const p = doc.data();
                feed.innerHTML += `<div class="post"><strong>${p.username}</strong><p>${p.content}</p></div>`;
            });
        });
    </script>
</body>
</html>
