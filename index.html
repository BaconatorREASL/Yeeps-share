    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yeeps-Share | Global Feed</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <script>
        // --- 1. FIREBASE CONFIG (PASTE YOUR KEYS HERE) ---
        const firebaseConfig = {
            apiKey: "AIzaSyDgsr50jIKTUyK6V4PcjjVpRKfvuG3sYd8",
  authDomain: "yeeps-sharee.firebaseapp.com",
  projectId: "yeeps-sharee",
  storageBucket: "yeeps-sharee.firebasestorage.app",
  messagingSenderId: "1065169328522",
  appId: "1:1065169328522:web:6d3b18ba2c990e83f51073",
  measurementId: "G-Z2CDN9SFPQ"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // --- 2. SECURITY & LOGIN CHECK ---
        const ADMIN_NAME = "DatWeirdFNFfan";
        const currentUser = localStorage.getItem('current_yeep_user');
        const statusDB = JSON.parse(localStorage.getItem('yeeps_status_db')) || {};

        if (currentUser && statusDB[currentUser]) {
            const s = statusDB[currentUser];
            if (s.type === "ban_perm" || (s.expires && s.expires > Date.now())) {
                window.location.href = "ban.html";
            }
        }
        if (!currentUser) window.location.href = "login.html";
    </script>

    <nav class="top-nav">
        <a href="index.html">üè† Home</a>
        <a href="pages/profile-editor.html">‚öôÔ∏è Settings</a>
        <a href="#" onclick="localStorage.removeItem('current_yeep_user'); location.reload();" style="color:red;">Logout</a>
    </nav>

    <div id="staffPanel" style="display:none;" class="admin-panel">
        <h3 style="color:var(--yeeps-orange); margin-top:0;">üõ†Ô∏è Staff Dashboard</h3>
        <input type="text" id="modTarget" placeholder="Target Username">
        <input type="text" id="modReason" placeholder="Reason for ban/warn">
        <div style="display:flex; gap:10px;">
            <select id="modAction">
                <option value="warn">‚ö†Ô∏è Warn</option>
                <option value="timeout_10">üïí 10m Timeout</option>
                <option value="ban_perm">üö´ Permanent Ban</option>
            </select>
            <button onclick="applyMod()" style="background:red; color:white;">Execute</button>
        </div>
        <div id="ownerOnly" style="display:none; margin-top:10px; border-top:1px solid #444; padding-top:10px;">
            <select id="roleSelect">
                <option value="creator">Creator</option>
                <option value="rat">Lab Rat</option>
                <option value="star">Star</option>
                <option value="webmod">Web Mod</option>
                <option value="dev">Dev</option>
            </select>
            <button onclick="manageRole('add')" style="background:var(--yeeps-orange);">Add Role</button>
        </div>
    </div>

    <div class="input-box">
        <textarea id="postContent" placeholder="What's happening?"></textarea>
        <input type="text" id="mediaUrl" placeholder="Image/YouTube Link">
        <button id="postBtn" onclick="submitPost()" style="width:100%; background:var(--yeeps-orange); color:white; margin-top:10px;">POST TO SERVER</button>
    </div>

    <div id="featured-zone"></div>
    <div id="feed"></div>

    <script>
        const rolesDB = JSON.parse(localStorage.getItem('yeeps_roles_db')) || {};
        const usersDB = JSON.parse(localStorage.getItem('yeeps_users_db')) || {};
        const myRoles = (currentUser === ADMIN_NAME) ? ["owner"] : (rolesDB[currentUser] || []);
        const isOwner = (currentUser === ADMIN_NAME);
        const isStaff = myRoles.some(r => ["owner", "dev", "webmod"].includes(r));

        if(isStaff) document.getElementById('staffPanel').style.display = "block";
        if(isOwner) document.getElementById('ownerOnly').style.display = "block";

        // POST TO CLOUD
        async function submitPost() {
            const content = document.getElementById('postContent').value.trim();
            const media = document.getElementById('mediaUrl').value.trim();
            if(!content && !media) return;

            await db.collection("posts").add({
                username: currentUser,
                content: content,
                media: media,
                likes: [],
                featured: false,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            });

            document.getElementById('postContent').value = "";
            document.getElementById('mediaUrl').value = "";
        }

        // LOAD FEED FROM CLOUD
        function loadFeed() {
            db.collection("posts").orderBy("timestamp", "desc").onSnapshot((snapshot) => {
                const feed = document.getElementById('feed');
                const feat = document.getElementById('featured-zone');
                feed.innerHTML = ""; feat.innerHTML = "";

                snapshot.forEach((doc) => {
                    const p = doc.data();
                    const id = doc.id;
                    const pfp = usersDB[p.username]?.pfp || "https://ui-avatars.com/api/?name=" + p.username;
                    const liked = p.likes?.includes(currentUser);

                    const div = document.createElement('div');
                    div.className = `post ${p.featured ? 'pinned' : ''}`;
                    div.innerHTML = `
                        <div style="display:flex; justify-content:space-between;">
                            <div style="display:flex; align-items:center; gap:10px;">
                                <img src="${pfp}" class="pfp-img" onclick="location.href='pages/user-profile.html?u=${p.username}'">
                                <strong onclick="location.href='pages/user-profile.html?u=${p.username}'" style="cursor:pointer;">${p.username}</strong>
                            </div>
                            <div>
                                ${isOwner ? `<span onclick="toggleFeature('${id}', ${p.featured})" style="cursor:pointer;">‚≠ê</span>` : ''}
                                ${(isStaff || p.username === currentUser) ? `<span onclick="deletePost('${id}')" style="cursor:pointer; color:red; margin-left:10px;">üóëÔ∏è</span>` : ''}
                            </div>
                        </div>
                        <p>${p.content}</p>
                        ${p.media ? `<img src="${p.media}" style="width:100%; border-radius:10px; margin-top:10px;" onerror="this.style.display='none'">` : ''}
                        <div style="margin-top:10px;">
                            <span onclick="likePost('${id}')" style="cursor:pointer; color:${liked ? 'orange':'gray'}">‚ù§Ô∏è ${p.likes?.length || 0}</span>
                        </div>
                    `;
                    p.featured ? feat.appendChild(div) : feed.appendChild(div);
                });
            });
        }

        function likePost(id) {
            const ref = db.collection("posts").doc(id);
            db.runTransaction(async (t) => {
                const doc = await t.get(ref);
                let likes = doc.data().likes || [];
                if(likes.includes(currentUser)) likes = likes.filter(u => u !== currentUser);
                else likes.push(currentUser);
                t.update(ref, { likes: likes });
            });
        }

        function deletePost(id) { if(confirm("Delete post?")) db.collection("posts").doc(id).delete(); }
        function toggleFeature(id, stat) { db.collection("posts").doc(id).update({ featured: !stat }); }

        loadFeed();
    </script>
</body>
</html>
